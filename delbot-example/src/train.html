<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TensorFlow.js Model mouse</title>

  <!-- Import TensorFlow.js and tfjs-vis -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.0.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.5.1/dist/tfjs-vis.umd.min.js"></script>

  <!--script src="https://cdn.jsdelivr.net/npm/@chrisgdt/delbot-mouse@1.1.1/dist/delbot.js"></script-->
  <script src="../../delbot-core/dist/delbot.js"></script>

  <!--script src="https://cdn.jsdelivr.net/npm/@chrisgdt/delbot-training@1.1.1/dist/delbot-training.js"></script-->
  <script src="../../delbot-training/dist/delbot-training.js"></script>

  <script>
    const dataMatrix = new delbotrain.DataTraining({data: new delbot.data.DataMovementMatrix({numClasses:2}), normalize: false});
    const dataSimplePos = new delbotrain.DataTraining({data: new delbot.data.DataSimplePosition({numClasses:2})});
    const dataOffsetPos = new delbotrain.DataTraining({data: new delbot.data.DataOffsetPosition({numClasses:2})});
    const dataFeatures2 = new delbotrain.DataTraining({data: new delbot.data.DataFeatures2({numClasses:2})});


    const modelConvMovement = new delbotrain.ModelConvolutional({
      dataTraining: dataMatrix,
      nameToSave: "downloads://model-conv-matrix",
      epoch: 30,
      useTfjsVis: true,
      consoleInfo: true,
      optimizer: tf.train.adam(.001),
    }); // human 0.9212 406, bot 0.8047 594 -> 85.1%

    const modelDenseMatrix = new delbotrain.ModelDense({
      dataTraining: dataMatrix,
      nameToSave: "downloads://model-dense-matrix",
      epoch: 15,
      useTfjsVis: true,
      consoleInfo: true
    }); // human 0.8839 422, bot 0.8945 578 -> 89%
    const modelDenseFeatures = new delbotrain.ModelDense({
      dataTraining: dataFeatures2,
      nameToSave: "downloads://model-features2",
      epoch: 30,
      useTfjsVis: true,
      consoleInfo: true
    }); // human 0.8817 465, bot 0.6785 535 -> 77.3%
    const modelDenseSimplePos = new delbotrain.ModelDense({
      dataTraining: dataSimplePos,
      nameToSave: "downloads://model-dense-simple-pos",
      epoch: 30,
      useTfjsVis: true,
      consoleInfo: true
    }); // human 0.3924 446, bot 0.7852 554 -> 61%
    const modelDenseOffsetPos = new delbotrain.ModelDense({
      dataTraining: dataOffsetPos,
      nameToSave: "downloads://model-dense-offset-pos",
      epoch: 30,
      useTfjsVis: true,
      consoleInfo: true
    }); // human	0.8546	454, bot 0.3681 546 -> 58.9%

    const rnnSimplePos = new delbotrain.ModelRNN3({
      dataTraining: dataSimplePos,
      nameToSave: "downloads://model-rnn-simple-pos",
      epoch: 15,
      useTfjsVis: true,
      consoleInfo: true
    }); // human 0.3493 458, bot 0.8948 542 -> 64.5%
    const rnnOffsetPos = new delbotrain.ModelRNN3({
      dataTraining: dataOffsetPos,
      nameToSave: "downloads://model-rnn-offset-pos",
      epoch: 15,
      useTfjsVis: true,
      consoleInfo: true
    }); // don't converge (100% bot)

    const rnn1Features2 = new delbotrain.ModelRNN({
      dataTraining: dataFeatures2,
      nameToSave: "downloads://model-rnn1-features2",
      epoch: 20,
      useTfjsVis: true,
      consoleInfo: true
    }); // human 0.9438 463, bot 0.9683 537 -> 95.7%
    const rnn2Features2 = new delbotrain.ModelRNN2({
      dataTraining: dataFeatures2,
      nameToSave: "downloads://model-rnn2-features2",
      epoch: 25,
      useTfjsVis: true,
      consoleInfo: false
    }); // human 0.7954 479, bot 0.453 521 -> 61.7%
    const rnn3Features2 = new delbotrain.ModelRNN3({
      dataTraining: dataFeatures2,
      nameToSave: "downloads://model-rnn3-features2",
      epoch: 20,
      useTfjsVis: true,
      consoleInfo: true
    }); // human 0.9694 457, bot 0.9503 543 -> 95.9%

    // Delay for tfjs-vis
    document.addEventListener('DOMContentLoaded', () => {rnn3Features2.run()});
  </script>

</head>

<body>
</body>
</html>
